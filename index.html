<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAMING HUB | PRO ACCESS</title>
    <style>
        :root { --primary: #00ff41; --bg: #000; --glass: rgba(0, 20, 0, 0.9); --accent: #ff00ff; --admin-color: #00d9ff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Courier New', monospace; }
        body { background: var(--bg); color: var(--primary); overflow-x: hidden; }
        canvas { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.4; }
        .container { max-width: 480px; margin: 30px auto; padding: 20px; text-align: center; position: relative; z-index: 10; }
        .glass-card { background: var(--glass); border: 1px solid var(--primary); padding: 25px; border-radius: 12px; box-shadow: 0 0 20px rgba(0,255,65,0.2); backdrop-filter: blur(10px); }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid var(--primary); color: var(--primary); outline: none; border-radius: 5px; }
        .btn { display: block; width: 100%; padding: 14px; margin-top: 10px; border: 1px solid var(--primary); background: transparent; color: var(--primary); cursor: pointer; font-weight: bold; text-transform: uppercase; transition: 0.3s; border-radius: 5px; }
        .btn:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary); }
        .admin-box { border: 1px dashed var(--admin-color); padding: 15px; margin-top: 20px; color: var(--admin-color); border-radius: 8px; }
        .hidden { display: none; }
        .social-link { display: block; padding: 15px; margin-bottom: 10px; border: 1px solid var(--primary); color: var(--primary); text-decoration: none; font-weight: bold; border-radius: 5px; }
        .completed { background: var(--primary) !important; color: black !important; }
        .tool-card { background: rgba(0,0,0,0.8); padding: 15px; border: 1px solid var(--primary); margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px; }
    </style>
</head>
<body>

    <canvas id="matrix"></canvas>

    <div id="screen-login" class="container">
        <h1 style="font-size: 2.5rem; margin-bottom: 20px; text-shadow: 0 0 10px var(--primary);">GAMING HUB</h1>
        <div class="glass-card">
            <input type="password" id="auth-key" placeholder="ENTER LICENSE KEY...">
            <button class="btn" onclick="handleLogin()">INITIALIZE ACCESS</button>
        </div>
    </div>

    <div id="screen-admin" class="container hidden">
        <h2 style="color: var(--admin-color);">ADMIN TERMINAL</h2>
        <div class="glass-card" style="border-color: var(--admin-color);">
            
            <div class="admin-box" style="border-color: #ff4444; color: #ff4444;">
                <p>⚙️ CHANGE ADMIN PASSWORD</p>
                <input type="text" id="new-admin-pass" placeholder="Enter New Password">
                <button class="btn" style="border-color: #ff4444;" onclick="updateAdminPass()">UPDATE PASSWORD</button>
            </div>

            <div class="admin-box">
                <p>KEY MANAGEMENT</p>
                <input type="number" id="key-hours" placeholder="Hours" value="24">
                <button class="btn" style="border-color: var(--admin-color);" onclick="generateKey()">GENERATE KEY</button>
                <div id="new-key-res" style="margin:10px 0; font-size:14px; color:white;">No Key Generated</div>
            </div>

            <div class="admin-box" style="border-color: #f39c12; color: #f39c12;">
                <p>SOCIAL LINK LOCKER</p>
                <input type="text" id="link-tiktok" placeholder="TikTok URL">
                <input type="text" id="link-yt" placeholder="YouTube URL">
                <input type="text" id="link-wa" placeholder="WhatsApp URL">
                <button class="btn" style="border-color: #f39c12;" onclick="updateSocialLinks()">LOCK & SAVE LINKS</button>
            </div>

            <div class="admin-box" style="border-color: var(--primary);">
                <p>UPLOAD TOOL</p>
                <input type="text" id="tool-name" placeholder="Tool Name">
                <input type="text" id="tool-url" placeholder="Download URL">
                <button class="btn" onclick="uploadTool()">SEND TO CLOUD</button>
            </div>

            <button class="btn" onclick="location.reload()">LOGOUT</button>
        </div>
    </div>

    <div id="screen-verify" class="container hidden">
        <h2>VERIFY IDENTITY</h2>
        <div class="glass-card">
            <a href="#" target="_blank" class="social-link" id="s1" onclick="markStep('s1')">FOLLOW TIKTOK</a>
            <a href="#" target="_blank" class="social-link" id="s2" onclick="markStep('s2')">SUBSCRIBE YOUTUBE</a>
            <a href="#" target="_blank" class="social-link" id="s3" onclick="markStep('s3')">JOIN WHATSAPP</a>
            <div id="timer-box" style="display:none; color:gold; margin:15px;">WAITING: <span id="sec">15</span>s</div>
            <button id="gen-btn" class="btn" style="display:none;" onclick="startTimer()">ACCESS DATABASE</button>
        </div>
    </div>

    <div id="screen-tools" class="container hidden">
        <h2>DATABASE UNLOCKED</h2>
        <div id="tools-list" style="margin-top:20px;"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, getDoc, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC9THzTxB73m4OpeNE2tkmafvpExIGWlvg",
            authDomain: "gaming-d9494.firebaseapp.com",
            projectId: "gaming-d9494",
            storageBucket: "gaming-d9494.firebasestorage.app",
            messagingSenderId: "464029519961",
            appId: "1:464029519961:web:18db325072160f4c48a148"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- Matrix Rain ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const drops = Array(Math.floor(canvas.width/16)).fill(1);
        setInterval(() => {
            ctx.fillStyle = "rgba(0,0,0,0.05)"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#0F0"; ctx.font = "15px monospace";
            drops.forEach((y, i) => {
                ctx.fillText(String.fromCharCode(Math.random()*128), i*16, y*16);
                if(y*16 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }, 35);

        // --- Admin Password Logic ---
        window.handleLogin = async () => {
            const k = document.getElementById('auth-key').value.trim();
            
            // Database se password check karna
            const passSnap = await getDoc(doc(db, "settings", "adminConfig"));
            let correctPass = "killer786"; // Default password
            if(passSnap.exists()) {
                correctPass = passSnap.data().password;
            }

            if(k === correctPass) return show('screen-admin');
            
            const snap = await getDoc(doc(db, "keys", k));
            if(snap.exists() && Date.now() < snap.data().expiry) {
                const s = await getDoc(doc(db, "settings", "socials"));
                if(s.exists()){
                    document.getElementById('s1').href = s.data().tk;
                    document.getElementById('s2').href = s.data().yt;
                    document.getElementById('s3').href = s.data().wa;
                }
                show('screen-verify');
            } else alert("Invalid Key!");
        };

        window.updateAdminPass = async () => {
            const newPass = document.getElementById('new-admin-pass').value.trim();
            if(newPass.length < 4) return alert("Password too short!");
            await setDoc(doc(db, "settings", "adminConfig"), { password: newPass });
            alert("Admin Password Updated! Use this next time.");
        };

        // --- Other Functions ---
        window.generateKey = async () => {
            const h = document.getElementById('key-hours').value;
            const k = "KING-" + Math.random().toString(36).substring(2,8).toUpperCase();
            await setDoc(doc(db, "keys", k), { expiry: Date.now() + (h * 3600000) });
            document.getElementById('new-key-res').innerText = "KEY: " + k;
        };

        window.updateSocialLinks = async () => {
            const tk = document.getElementById('link-tiktok').value.trim();
            const yt = document.getElementById('link-yt').value.trim();
            const wa = document.getElementById('link-wa').value.trim();
            await setDoc(doc(db, "settings", "socials"), { tk, yt, wa });
            alert("Links Locked!");
        };

        window.uploadTool = async () => {
            const name = document.getElementById('tool-name').value;
            const url = document.getElementById('tool-url').value;
            if(name && url) await addDoc(collection(db, "tools"), { name, url, time: Date.now() });
            alert("Tool Added!");
        };

        let steps = new Set();
        window.markStep = (id) => {
            document.getElementById(id).classList.add('completed');
            steps.add(id);
            if(steps.size >= 3) document.getElementById('gen-btn').style.display = 'block';
        };

        window.startTimer = () => {
            document.getElementById('gen-btn').style.display = 'none';
            document.getElementById('timer-box').style.display = 'block';
            let t = 15;
            let timer = setInterval(() => {
                t--; document.getElementById('sec').innerText = t;
                if(t <= 0) { clearInterval(timer); show('screen-tools'); loadData(); }
            }, 1000);
        };

        function loadData() {
            onSnapshot(query(collection(db, "tools"), orderBy("time", "desc")), (s) => {
                const l = document.getElementById('tools-list'); l.innerHTML = "";
                s.forEach(d => l.innerHTML += `<div class="tool-card"><span>${d.data().name}</span><a href="${d.data().url}" target="_blank" style="color:lime">GET</a></div>`);
            });
        }

        function show(id) {
            document.querySelectorAll('.container').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }
    </script>
</body>
</html>
